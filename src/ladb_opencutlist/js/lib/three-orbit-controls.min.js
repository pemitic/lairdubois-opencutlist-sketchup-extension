!function(){const G={type:"change"},W={type:"start"},q={type:"end"};class e extends THREE.EventDispatcher{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",X),this._domElementKeyEvents=e},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(G),l.update(),m=p.NONE},this.update=function(){const o=new THREE.Vector3,a=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=a.clone().invert(),r=new THREE.Vector3,c=new THREE.Quaternion,s=2*Math.PI;return function(){var e=l.object.position;o.copy(e).sub(l.target),o.applyQuaternion(a),u.setFromVector3(o),l.autoRotate&&m===p.NONE&&y(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(u.theta+=h.theta*l.dampingFactor,u.phi+=h.phi*l.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let t=l.minAzimuthAngle,n=l.maxAzimuthAngle;return isFinite(t)&&isFinite(n)&&(t<-Math.PI?t+=s:t>Math.PI&&(t-=s),n<-Math.PI?n+=s:n>Math.PI&&(n-=s),t<=n?u.theta=Math.max(t,Math.min(n,u.theta)):u.theta=u.theta>(t+n)/2?Math.max(t,u.theta):Math.min(n,u.theta)),u.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=d,u.radius=Math.max(l.minDistance,Math.min(l.maxDistance,u.radius)),!0===l.enableDamping?l.target.addScaledVector(b,l.dampingFactor):l.target.add(b),o.setFromSpherical(u),o.applyQuaternion(i),e.copy(l.target).add(o),l.object.lookAt(l.target),!0===l.enableDamping?(h.theta*=1-l.dampingFactor,h.phi*=1-l.dampingFactor,b.multiplyScalar(1-l.dampingFactor)):(h.set(0,0,0),b.set(0,0,0)),d=1,!(!(T||r.distanceToSquared(l.object.position)>E||8*(1-c.dot(l.object.quaternion))>E)||(l.dispatchEvent(G),r.copy(l.object.position),c.copy(l.object.quaternion),T=!1))}}(),this.dispose=function(){l.domElement.removeEventListener("contextmenu",Z),l.domElement.removeEventListener("pointerdown",_),l.domElement.removeEventListener("pointercancel",z),l.domElement.removeEventListener("wheel",F),l.domElement.removeEventListener("pointermove",Y),l.domElement.removeEventListener("pointerup",x),null!==l._domElementKeyEvents&&l._domElementKeyEvents.removeEventListener("keydown",X)};const l=this,p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let m=p.NONE;const E=1e-6,u=new THREE.Spherical,h=new THREE.Spherical;let d=1;const b=new THREE.Vector3;let T=!1;const o=new THREE.Vector2,a=new THREE.Vector2,i=new THREE.Vector2,r=new THREE.Vector2,c=new THREE.Vector2,s=new THREE.Vector2,g=new THREE.Vector2,O=new THREE.Vector2,R=new THREE.Vector2,f=[],n={};function H(){return Math.pow(.95,l.zoomSpeed)}function y(e){h.theta-=e}function v(e){h.phi-=e}const P=function(){const n=new THREE.Vector3;return function(e,t){n.setFromMatrixColumn(t,0),n.multiplyScalar(-e),b.add(n)}}(),A=function(){const n=new THREE.Vector3;return function(e,t){!0===l.screenSpacePanning?n.setFromMatrixColumn(t,1):(n.setFromMatrixColumn(t,0),n.crossVectors(l.object.up,n)),n.multiplyScalar(e),b.add(n)}}(),L=function(){const a=new THREE.Vector3;return function(e,t){var n,o=l.domElement;l.object.isPerspectiveCamera?(n=l.object.position,a.copy(n).sub(l.target),n=a.length(),n*=Math.tan(l.object.fov/2*Math.PI/180),P(2*e*n/o.clientHeight,l.object.matrix),A(2*t*n/o.clientHeight,l.object.matrix)):l.object.isOrthographicCamera?(P(e*(l.object.right-l.object.left)/l.object.zoom/o.clientWidth,l.object.matrix),A(t*(l.object.top-l.object.bottom)/l.object.zoom/o.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function N(e){l.object.isPerspectiveCamera?d/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),T=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function w(e){l.object.isPerspectiveCamera?d*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),T=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function M(e){o.set(e.clientX,e.clientY)}function j(e){r.set(e.clientX,e.clientY)}function S(){var e,t;1===f.length?o.set(f[0].pageX,f[0].pageY):(e=.5*(f[0].pageX+f[1].pageX),t=.5*(f[0].pageY+f[1].pageY),o.set(e,t))}function k(){var e,t;1===f.length?r.set(f[0].pageX,f[0].pageY):(e=.5*(f[0].pageX+f[1].pageX),t=.5*(f[0].pageY+f[1].pageY),r.set(e,t))}function D(){var e=f[0].pageX-f[1].pageX,t=f[0].pageY-f[1].pageY,e=Math.sqrt(e*e+t*t);g.set(0,e)}function I(e){1==f.length?a.set(e.pageX,e.pageY):(n=C(e),t=.5*(e.pageX+n.x),e=.5*(e.pageY+n.y),a.set(t,e)),i.subVectors(a,o).multiplyScalar(l.rotateSpeed);var t,n=l.domElement;y(2*Math.PI*i.x/n.clientHeight),v(2*Math.PI*i.y/n.clientHeight),o.copy(a)}function U(e){var t,n;1===f.length?c.set(e.pageX,e.pageY):(t=C(e),n=.5*(e.pageX+t.x),e=.5*(e.pageY+t.y),c.set(n,e)),s.subVectors(c,r).multiplyScalar(l.panSpeed),L(s.x,s.y),r.copy(c)}function V(e){var t=C(e),n=e.pageX-t.x,e=e.pageY-t.y,t=Math.sqrt(n*n+e*e);O.set(0,t),R.set(0,Math.pow(O.y/g.y,l.zoomSpeed)),N(R.y),g.copy(O)}function _(t){if(!1!==l.enabled){var e;if(0===f.length&&(l.domElement.setPointerCapture(t.pointerId),l.domElement.addEventListener("pointermove",Y),l.domElement.addEventListener("pointerup",x)),e=t,f.push(e),"touch"!==t.pointerType){var n=t;let e;switch(n.button){case 0:e=l.mouseButtons.LEFT;break;case 1:e=l.mouseButtons.MIDDLE;break;case 2:e=l.mouseButtons.RIGHT;break;default:e=-1}switch(e){case THREE.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(e){g.set(e.clientX,e.clientY)}(n),m=p.DOLLY;break;case THREE.MOUSE.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===l.enablePan)return;j(n),m=p.PAN}else{if(!1===l.enableRotate)return;M(n),m=p.ROTATE}break;case THREE.MOUSE.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(!1===l.enableRotate)return;M(n),m=p.ROTATE}else{if(!1===l.enablePan)return;j(n),m=p.PAN}break;default:m=p.NONE}}else switch(B(t),f.length){case 1:switch(l.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===l.enableRotate)return;S(),m=p.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===l.enablePan)return;k(),m=p.TOUCH_PAN;break;default:m=p.NONE}break;case 2:switch(l.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;l.enableZoom&&D(),l.enablePan&&k(),m=p.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;l.enableZoom&&D(),l.enableRotate&&S(),m=p.TOUCH_DOLLY_ROTATE;break;default:m=p.NONE}break;default:m=p.NONE}m!==p.NONE&&l.dispatchEvent(W)}}function Y(e){if(!1!==l.enabled)if("touch"===e.pointerType){var t=e;switch(B(t),m){case p.TOUCH_ROTATE:!1!==l.enableRotate&&(I(t),l.update());break;case p.TOUCH_PAN:!1!==l.enablePan&&(U(t),l.update());break;case p.TOUCH_DOLLY_PAN:!1===l.enableZoom&&!1===l.enablePan||(!function(e){l.enableZoom&&V(e),l.enablePan&&U(e)}(t),l.update());break;case p.TOUCH_DOLLY_ROTATE:!1===l.enableZoom&&!1===l.enableRotate||(!function(e){l.enableZoom&&V(e),l.enableRotate&&I(e)}(t),l.update());break;default:m=p.NONE}}else{var n=e;switch(m){case p.ROTATE:!1!==l.enableRotate&&!function(e){a.set(e.clientX,e.clientY),i.subVectors(a,o).multiplyScalar(l.rotateSpeed),e=l.domElement,y(2*Math.PI*i.x/e.clientHeight),v(2*Math.PI*i.y/e.clientHeight),o.copy(a),l.update()}(n);break;case p.DOLLY:!1!==l.enableZoom&&!function(e){O.set(e.clientX,e.clientY),R.subVectors(O,g),0<R.y?N(H()):R.y<0&&w(H()),g.copy(O),l.update()}(n);break;case p.PAN:!1!==l.enablePan&&!function(e){c.set(e.clientX,e.clientY),s.subVectors(c,r).multiplyScalar(l.panSpeed),L(s.x,s.y),r.copy(c),l.update()}(n)}}}function x(e){K(e),0===f.length&&(l.domElement.releasePointerCapture(e.pointerId),l.domElement.removeEventListener("pointermove",Y),l.domElement.removeEventListener("pointerup",x)),l.dispatchEvent(q),m=p.NONE}function z(e){K(e)}function F(e){!1!==l.enabled&&!1!==l.enableZoom&&m===p.NONE&&(e.preventDefault(),l.dispatchEvent(W),(e=e).deltaY<0?w(H()):0<e.deltaY&&N(H()),l.update(),l.dispatchEvent(q))}function X(t){if(!1!==l.enabled&&!1!==l.enablePan){let e=!1;switch(t.code){case l.keys.UP:L(0,l.keyPanSpeed),e=!0;break;case l.keys.BOTTOM:L(0,-l.keyPanSpeed),e=!0;break;case l.keys.LEFT:L(l.keyPanSpeed,0),e=!0;break;case l.keys.RIGHT:L(-l.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),l.update())}}function Z(e){!1!==l.enabled&&e.preventDefault()}function K(t){delete n[t.pointerId];for(let e=0;e<f.length;e++)if(f[e].pointerId==t.pointerId)return void f.splice(e,1)}function B(e){let t=n[e.pointerId];void 0===t&&(t=new THREE.Vector2,n[e.pointerId]=t),t.set(e.pageX,e.pageY)}function C(e){e=e.pointerId===f[0].pointerId?f[1]:f[0];return n[e.pointerId]}l.domElement.addEventListener("contextmenu",Z),l.domElement.addEventListener("pointerdown",_),l.domElement.addEventListener("pointercancel",z),l.domElement.addEventListener("wheel",F,{passive:!1}),this.update()}}THREE.MapControls=class extends e{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE}},THREE.OrbitControls=e}();